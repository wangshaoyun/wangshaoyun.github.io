---
layout: post
title: Beams with circuits
category: Mechanics
tags: Mechanics
---



# Plans

1. Calculate the dispersion curves analytically by transfer matrix and compare it with COMSOL simulation.
2. Discuss skin mode, topological edege mode, PBC and OBC relation.
3. Calculate the bulk topological invariant.
4. Create the equivalent piezoelectric beam model by homogenization.
5. Transient analysis.

# 2 Piezoelectric beam with shunt circuit

| <img src="/Users/wang/Documents/GitHub/wangshaoyun.github.io/_posts/assets/202211022334303.png" style="zoom:33%;" /> | <img src="/Users/wang/Documents/GitHub/wangshaoyun.github.io/_posts/assets/202211032054699.png" style="zoom:25%;" /> |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|                                                              |                   Figure 2. NH SSH circuit                   |



The piezoelectric constitutive law for beam:
$$
\left[\begin{array}{l}
S_1 \\
D_3
\end{array}\right]=\left[\begin{array}{ll}
s_{11}^E & d_{31} \\
d_{31} & \varepsilon_{33}^T
\end{array}\right]\left[\begin{array}{c}
T_1 \\
E_3
\end{array}\right]
$$
The impedance *Z* of the shunting circuit connecting to each PZT patch can then be written as
$$
Z= \frac{1}{\frac{1}{1/C_ns}+\frac{1}{Ls+R}} = \frac{1 /\left(-C_{\mathrm{n}} s\right) \cdot(L s+R)}{1 /\left(-C_{\mathrm{n}} s\right)+(L s+R)}
$$
where $s=i\omega$. The electric current generated by each piezoelectric patch can be written as
$$
I=\frac{E_3 h_{\mathrm{p}}}{Z}=-A_{\mathrm{s}} D_3 s
$$
or
$$
D_3 = -\frac{h_{\mathrm{p}}}{sA_sZ} E_3
$$
with Eq. (1-2), we have
$$
T_1 = d_{31}^{-1} (D_3-\varepsilon_{33}^TE_3) = -d_{31}^{-1}  \frac{sA_sZ + h_{\mathrm{p}}}{sA_sZ} E_3
$$
Inserting into Eq. (1-2), we have
$$
S_1 = s_{11}^E T_1 + d_{31} E_3 = s_{11}^E T_1 - \frac{d_{31}^2 sA_sZ}{sA_sZ + E_3 h_{\mathrm{p}}} T_1 = 
\left(s_{11}^E - \frac{d_{31}^2 sA_sZ}{sA_sZ + h_{\mathrm{p}}} \right) T_1
$$
 By applying Eq. (3) in Eq. (1), we obtain
$$
S_1=\left[s_{11}^E-\frac{d_{31}^2 A_{\mathrm{s}} h_{\mathrm{p}}^{-1}\left(L s^2+R s\right)}{1+\left(L s^2+R s\right)\left(C_{\mathrm{p}}-C_{\mathrm{n}}\right)}\right] T_1
$$
By defining 
$$
C_{\mathrm{p}}=\frac{\varepsilon_{33}^T A_{\mathrm{s}}}{h_{\mathrm{p}}}
$$
we have
$$
E_{\mathrm{p}}=\frac{T_1}{S_1}=\frac{1+\left(L s^2+R s\right)\left(C_{\mathrm{p}}-C_{\mathrm{n}}\right)}{s_{11}^E+\left(L s^2+R s\right)\left[s_{11}^E\left(C_{\mathrm{p}}-C_{\mathrm{n}}\right)-d_{31}^2 A_{\mathrm{s}} h_{\mathrm{p}}^{-1}\right]} .
$$

## 2.1 Shunting negative capacity

If shunted with a negative capacity, we have
$$
Z = \frac{1}{C_ns}
$$
and
$$
D_3 = -\frac{h_{\mathrm{p}}C_n}{A_s} E_3
$$
then
$$
T_1 = d_{31}^{-1} (D_3-\varepsilon_{33}^TE_3) = -d_{31}^{-1} \left(\frac{h_{\mathrm{p}}C_n}{A_s}+\varepsilon_{33}^T \right) E_3
$$
and
$$
S_1 = s_{11}^E T_1 + d_{31} E_3 = \left(s_{11}^E - \frac{d_{31}^2}{\frac{h_pC_n}{A_s}+\varepsilon_{33}^T} \right) T_1
$$



# 3 Purely Circuit

## 3.1 For $n$th unit cell

In figure 2, for intracell inductor and capacity, we have
$$
\left.\begin{array}{l}
I_{\mathrm{A}}(x)=\left(i \omega C_1+\frac{1}{i \omega L_1}\right)\left(V_{\mathrm{A}}(x)-V_{\mathrm{B}}(x)\right) \\
I_{\mathrm{B}}(x)=\left(i \omega C_1+\frac{1}{i \omega L_1}\right)\left(V_{\mathrm{B}}(x)-V_{\mathrm{A}}(x)\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{l}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}}\left(i \omega C_1+\frac{1}{i \omega L_1}\right)\left(\begin{array}{cc}
\delta_{x, x^{\prime}} & -\delta_{x, x^{\prime}} \\
-\delta_{x, x^{\prime}} & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right),
$$
For the intercell capacity , we have
$$
\left.\begin{array}{c}
I_{\mathrm{A}}(x)=i \omega C_2\left(V_{\mathrm{A}}(x)-V_{\mathrm{B}}(x-1)\right) \\
I_{\mathrm{B}}(x)=i \omega C_2\left(V_{\mathrm{B}}(x)-V_{\mathrm{A}}(x+1)\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{l}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}} i \omega C_2\left(\begin{array}{cc}
\delta_{x, x^{\prime}} & -\delta_{x-1, x^{\prime}} \\
-\delta_{x+1, x^{\prime}} & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right),
$$
For INIC, we have
$$
\left.\begin{array}{l}
I_{\mathrm{A}}(x)=-i \omega C_3\left(V_{\mathrm{A}}(x)-V_{\mathrm{B}}(x)\right) \\
I_{\mathrm{B}}(x)=i \omega C_3\left(V_{\mathrm{B}}(x)-V_{\mathrm{A}}(x)\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{c}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}} i \omega C_3\left(\begin{array}{ll}
-\delta_{x, x^{\prime}} & \delta_{x, x^{\prime}} \\
-\delta_{x, x^{\prime}} & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right)
$$
For the ground circuit, we have
$$
\begin{aligned}
&\left.\begin{array}{l}
I_{\mathrm{A}}(x)=\left(i \omega C_0+\frac{1}{i \omega L_0}+\frac{1}{R_0}\right)\left(V_{\mathrm{A}}(x)-0\right) \\
I_{\mathrm{B}}(x)=\left(\frac{1}{i \omega L_0}+\frac{1}{R_0}\right)\left(V_{\mathrm{B}}(x)-0\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{l}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}}\left(\frac{1}{i \omega L_0}+\frac{1}{R_0}\right)\left(\begin{array}{cc}
\delta_{x, x^{\prime}} & 0 \\
0 & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{c}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right)+\sum_{x^{\prime}}\left(i \omega C_0\right)\left(\begin{array}{cc}
\delta_{x, x^{\prime}} & 0 \\
0 & 0
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right)
\end{aligned}
$$


## 3.2 Bloch condition

Imposing Bloch boundary condition, we have intracell hopping
$$
\left(\begin{array}{l}
I_{12} \\
I_{21}
\end{array}\right)=i \omega \underbrace{\left(C_1-\frac{1}{\omega^2 L_1}\right)} =\left(\begin{array}{cc}
1 & -1 \\
-1 & 1
\end{array}\right)\left(\begin{array}{l}
V_1 \\
V_2
\end{array}\right) \\
\equiv v(\omega)
$$
intercell hopping 
$$
\left(\begin{array}{l}
I_{12} \\
I_{21}
\end{array}\right)=i \omega \underbrace{C_2}\left(\begin{array}{cc}
1 & -\mathrm{e}^{-i k} \\
-\mathrm{e}^{i k} & 1
\end{array}\right)\left(\begin{array}{l}
V_1 \\
V_2
\end{array}\right) \\
 \equiv r
$$
and non-Hermitian hopping
$$
\left(\begin{array}{l}
I_{12} \\
I_{21}
\end{array}\right)=i \omega \underbrace{C_3} \left(\begin{array}{ll}
-1 & 1 \\
-1 & 1
\end{array}\right)\left(\begin{array}{l}
V_1 \\
V_2
\end{array}\right)\\
\equiv \gamma
$$
And we set $C_0=2C_3$ to keep the system with chiral symmetry. Finally, we have
$$
\left(\begin{array}{l}
I_{12} \\
I_{21}
\end{array}\right)=i \omega\left(\begin{array}{ll}
 C_3 +  \left(C_1-\frac{1}{\omega^2 L_1}\right) + C_2  &  C_3 - \left(C_1-\frac{1}{\omega^2 L_1}\right) -C_2 \mathrm{e}^{-i k}  \\
 -C_3 - \left(C_1-\frac{1}{\omega^2 L_1}\right) -C_2 \mathrm{e}^{-i k} & C_3 + \left(C_1-\frac{1}{\omega^2 L_1}\right)  + C_2
\end{array}\right)\left(\begin{array}{l}
V_1 \\
V_2
\end{array}\right)\\
$$
or
$$
\left(\begin{array}{l}
I_{12} \\
I_{21}
\end{array}\right)=\left(\begin{array}{ll}
\nu+r+\gamma  & \nu+r\mathrm{e}^{-i k} +\gamma  \\
\nu+r\mathrm{e}^{-i k} -\gamma & \nu+r+\gamma
\end{array}\right)\left(\begin{array}{l}
V_1 \\
V_2
\end{array}\right)\\
$$
which is actually the SSH model in previous paper [4]. 

# 4 Non-Hermitian piezoelectric beam with circuit

## 4.1 Beam subsystem

| <img src="/Users/wang/Documents/GitHub/wangshaoyun.github.io/_posts/assets/202211032150637.png" style="zoom:25%;" /> |
| :----------------------------------------------------------: |
|         Figure 3: Non-Hermitian SSH circuit and beam         |

The constitutive relation for piezoelectric beam is
$$
\left[\begin{array}{l}
S_1 \\
D_3
\end{array}\right]=\left[\begin{array}{ll}
s_{11}^E & d_{31} \\
d_{31} & \varepsilon_{33}^T
\end{array}\right]\left[\begin{array}{c}
T_1 \\
E_3
\end{array}\right]
$$

### 4.1.1 Segement with piezoelectric patch

The governing equations for the beam are
$$
\left\{\begin{array}{l} \label{governing_eq1}
\frac{\mathrm{d} w}{\mathrm{~d} x}=w_x, \quad D_a \frac{\mathrm{d} w_x}{\mathrm{~d} x}=M+\lambda V_{c} \\
\frac{\mathrm{d} M}{\mathrm{~d} x}=-Q, \quad \frac{\mathrm{d} Q}{\mathrm{~d} x}=-\omega^2 m_a w
\end{array}\right.
$$
where $D_a$ and $m_a$ are the bending rigidity and linear mass density of segment $a$, respectively, given as
$$
\left\{\begin{array}{l}
D_a=E_b b_b / 3 \left[h_b^3/4 + h_b(h_b/2-h_c)^2 \right] + E_p b_p/3 \left[h_p^3/4+h_p(h_p/2+h_c)^2\right] \\
m_a=\rho_b b_b h_b+\rho_p b_p h_p
\end{array}\right.
$$
$V_{c}$ is the voltage on PZT patches. The electrical-mechanical coupling coefficient $\lambda$ is given as [Appendix]
$$
\lambda=E_p d_{31} b_p \cdot\left(h_p/2+h_c\right)
$$
Define the dynamic state variables as $\mathbf{Y}=\left[w, w_x, M, Q\right]^{\mathrm{T}}$, so Eq. (17) can be rewritten as matrix form
$$
\mathbf{Y}^{\prime}=\mathbf{C}_a \cdot \mathbf{Y}+\mathbf{J}_a \cdot V_c
$$
where
$$
\mathbf{C}_a=\left[\begin{array}{cccc}
0 & 1 & 0 & 0 \\
0 & 0 & 1 / D_a & 0 \\
0 & 0 & 0 & -1 \\
-\omega^2 m_a & 0 & 0 & 0
\end{array}\right] \mathbf{Y}, \quad \mathbf{J}_a=\left[\begin{array}{c}
0 \\
\lambda / D_a \\
0 \\
0
\end{array}\right]
$$
The special solution of Eq. (20) is 
$$
\mathbf{Y}=\gamma e^{\mathbf{C}_a x}-\mathbf{C}_a^{-1} \cdot \mathbf{J}_a \cdot V_c
$$
from which, we can readily derive the relation between $\mathbf{Y}$ at position $x_{\mathrm{m}}$ and that at position $x_n$, given as
$$
\mathbf{Y}_{\mathrm{a+1}}+\mathbf{C}_a^{-1} \cdot \mathbf{J}_a \cdot V_c=\mathbf{H}_a \cdot\left(\mathbf{Y}_a+\mathbf{C}_a^{-1} \cdot \mathbf{J}_a \cdot V_c\right)
$$
where $\mathbf{H}_a=e^{\mathbf{C}_a \cdot (l_{a+1}-l_{a})}$.

### 4.1.2 Segement without piezoelectric patch

The governing equations for the beam are
$$
\left\{\begin{array}{l}
\frac{\mathrm{d} w}{\mathrm{~d} x}=w_x, \quad D_a \frac{\mathrm{d} w_x}{\mathrm{~d} x}=M \\
\frac{\mathrm{d} M}{\mathrm{~d} x}=-Q, \quad \frac{\mathrm{d} Q}{\mathrm{~d} x}=-\omega^2 m_a w
\end{array}\right.
$$
where $D_a$ and $m_a$ are the bending rigidity and linear mass density of segment $a$, respectively, given as
$$
\left\{\begin{array}{l}
D_a=E_b b_b h_b^3 / 12 \\
m_a=\rho_b b_b h_b
\end{array}\right.
$$
Define the dynamic state variables as $\mathbf{Y}=\left[w, w_x, M, Q\right]^{\mathrm{T}}$, so Eq. ($\ref{governing_eq1}$) can be rewritten as matrix form
$$
\mathbf{Y}^{\prime}=\mathbf{C}_a \cdot \mathbf{Y}
$$
where
$$
\mathbf{C}_a=\left[\begin{array}{cccc}
0 & 1 & 0 & 0 \\
0 & 0 & 1 / D_a & 0 \\
0 & 0 & 0 & -1 \\
-\omega^2 m_a & 0 & 0 & 0
\end{array}\right]
$$
Similarly, we have the transfer matrix
$$
\mathbf{Y}_{a+1}=\mathbf{H}_a \cdot \mathbf{Y}_{\mathrm{a}}
$$

where $\mathbf{H}_a=e^{\mathbf{C}_a \cdot\left(l_{a+1}-l_{l_a}\right)}$.

### 4.1.3 Transfer matrix

For segments 1-4, we have
$$
\mathbf{Y}_{\mathrm{1}}-\mathbf{H}_0 \cdot \mathbf{Y}_0 = (\mathbf{H}_0-I) \cdot \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A \\
\mathbf{Y}_{2}=\mathbf{H}_1 \cdot \mathbf{Y}_{\mathrm{1}} \\
\mathbf{Y}_{\mathrm{3}}-\mathbf{H}_2 \cdot \mathbf{Y}_2 = (\mathbf{H}_2-I) \cdot \mathbf{C}_2^{-1} \cdot \mathbf{J}_2 \cdot V_B \\
\mathbf{Y}_{4}=\mathbf{H}_3 \cdot \mathbf{Y}_{\mathrm{3}} \\
$$
Finally, we have
$$
\mathbf{Y}_{1}=\mathbf{H}_0 \cdot \mathbf{Y}_0 + (\mathbf{H}_0-I) \cdot \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A \\
\mathbf{Y}_{2}=\mathbf{H}_1\mathbf{H}_0\mathbf{Y}_{\mathrm{0}} + \mathbf{H}_1(\mathbf{H}_0-I) \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A \\
\mathbf{Y}_{3}=\mathbf{H}_2\mathbf{H}_1\mathbf{H}_0\mathbf{Y}_{\mathrm{0}} + \mathbf{H}_2\mathbf{H}_1(\mathbf{H}_0-I) \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A +(\mathbf{H}_2-I) \mathbf{C}_2^{-1} \cdot \mathbf{J}_2 \cdot V_B \\
\mathbf{Y}_{4}=\mathbf{H}_3\mathbf{H}_2\mathbf{H}_1\mathbf{H}_0\mathbf{Y}_{\mathrm{0}} + \mathbf{H}_3\mathbf{H}_2\mathbf{H}_1(\mathbf{H}_0-I) \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A + \mathbf{H}_3(\mathbf{H}_2-I) \mathbf{C}_2^{-1} \cdot \mathbf{J}_2 \cdot V_B
$$

## 4.2 Circuit subsystem

**The direction of circuit is the direction flowing in the node.**

In figure 3, for intracell inductor and capacity, we have
$$
\left.\begin{array}{l}
I_{\mathrm{A}}(x)=\left(i \omega C_1+\frac{1}{i \omega L_1}\right)\left(V_{\mathrm{A}}(x)-V_{\mathrm{B}}(x)\right) \\
I_{\mathrm{B}}(x)=\left(i \omega C_1+\frac{1}{i \omega L_1}\right)\left(V_{\mathrm{B}}(x)-V_{\mathrm{A}}(x)\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{l}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}}\left(i \omega C_1+\frac{1}{i \omega L_1}\right)\left(\begin{array}{cc}
\delta_{x, x^{\prime}} & -\delta_{x, x^{\prime}} \\
-\delta_{x, x^{\prime}} & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right),
$$
For the intercell capacity , we have
$$
\left.\begin{array}{c}
I_{\mathrm{A}}(x)=i \omega C_2\left(V_{\mathrm{A}}(x)-V_{\mathrm{B}}(x-1)\right) \\
I_{\mathrm{B}}(x)=i \omega C_2\left(V_{\mathrm{B}}(x)-V_{\mathrm{A}}(x+1)\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{l}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}} i \omega C_2\left(\begin{array}{cc}
\delta_{x, x^{\prime}} & -\delta_{x-1, x^{\prime}} \\
-\delta_{x+1, x^{\prime}} & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right),
$$
For INIC, we have
$$
\left.\begin{array}{l}
I_{\mathrm{A}}(x)=-i \omega C_3\left(V_{\mathrm{A}}(x)-V_{\mathrm{B}}(x)\right) \\
I_{\mathrm{B}}(x)=i \omega C_3\left(V_{\mathrm{B}}(x)-V_{\mathrm{A}}(x)\right)
\end{array}\right\} \Rightarrow\left(\begin{array}{c}
I_{\mathrm{A}}(x) \\
I_{\mathrm{B}}(x)
\end{array}\right)=\sum_{x^{\prime}} i \omega C_3\left(\begin{array}{ll}
-\delta_{x, x^{\prime}} & \delta_{x, x^{\prime}} \\
-\delta_{x, x^{\prime}} & \delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right)
$$
For the circuit from piezoelectric patchs, we have
$$
\begin{aligned}
&\left.\begin{array}{l}
I_{\mathrm{A}}(x)=-i\omega \lambda (w_{x}|_{x=x_1 }-w_{x} |_{x=x_0}) - i \omega C_p V_A\\
I_{\mathrm{B}}(x)=-i\omega \lambda (w_{x}|_{x=x_3 }-w_{x} |_{x=x_2}) - i \omega C_p V_A
\end{array}\right\}
\end{aligned}
$$

Summing Eq. (29-32) up, we have
$$
\left(\begin{array}{l}
\lambda (w_{x}|_{x=x_1 }-w_{x} |_{x=x_0}) \\
\lambda (w_{x}|_{x=x_3 }-w_{x} |_{x=x_2})
\end{array}\right) = \sum_{x^{\prime}} \left(\begin{array}{cc}
(v+r-\gamma)\delta_{x, x^{\prime}} & (\gamma-v)\delta_{x, x^{\prime}} - r\delta_{x-1, x^{\prime}} \\
-(\gamma+v)\delta_{x, x^{\prime}}-r\delta_{x+1, x^{\prime}} & (v+r+\gamma)\delta_{x, x^{\prime}}
\end{array}\right)\left(\begin{array}{l}
V_{\mathrm{A}}\left(x^{\prime}\right) \\
V_{\mathrm{B}}\left(x^{\prime}\right)
\end{array}\right),
$$
By imposing Bloch boundary condition, we have
$$
\left(\begin{array}{l}
\lambda \boldsymbol{J}\cdot(\boldsymbol{Y}_1-\boldsymbol{Y}_0) \\
\lambda \boldsymbol{J}\cdot(\boldsymbol{Y}_3-\boldsymbol{Y}_2)
\end{array}\right)=\left(\begin{array}{ll}
\nu+r+\gamma  & \nu+r\mathrm{e}^{-i k} +\gamma  \\
\nu+r\mathrm{e}^{-i k} -\gamma & \nu+r+\gamma
\end{array}\right)\left(\begin{array}{l}
V_A \\
V_B
\end{array}\right) 
\equiv H V
$$
Substituting first 3 equations in Eq. (30) into Eq. (37), we have
$$
H_{11} V_A + H_{12} V_B = \lambda \boldsymbol{J}\cdot \left[ (\mathbf{H}_0-I) \cdot \mathbf{Y}_0 + (\mathbf{H}_0-I) \cdot \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A \right] \\
H_{21} V_A + H_{22} V_B = \lambda \boldsymbol{J}\cdot \left[  (\mathbf{H}_2-I)\mathbf{H}_1\mathbf{H}_0\mathbf{Y}_{\mathrm{0}} + (\mathbf{H}_2-I)\mathbf{H}_1(\mathbf{H}_0-I) \mathbf{C}_0^{-1} \cdot \mathbf{J}_0 \cdot V_A +(\mathbf{H}_2-I) \mathbf{C}_2^{-1} \cdot \mathbf{J}_2 \cdot V_B \right]  \\
$$
or
$$
[H_{11}-\lambda \boldsymbol{J}\cdot (\mathbf{H}_0-I) \cdot \mathbf{C}_0^{-1} \cdot \mathbf{J}_0] V_A + H_{12} V_B = \lambda \boldsymbol{J}\cdot(\mathbf{H}_0-I) \cdot \mathbf{Y}_0  \\
[H_{21}-\lambda \boldsymbol{J} (\mathbf{H}_2-I)\mathbf{H}_1(\mathbf{H}_0-I) \mathbf{C}_0^{-1} \cdot \mathbf{J}_0] V_A + [H_{22} -\lambda \boldsymbol{J} (\mathbf{H}_2-I) \mathbf{C}_2^{-1} \cdot \mathbf{J}_2] V_B = \lambda \boldsymbol{J}\cdot (\mathbf{H}_2-I)\mathbf{H}_1\mathbf{H}_0\mathbf{Y}_{\mathrm{0}}  \\
$$
By solving this equation, we can get $(V_a,V_b)^T$ and substituting them into the fourth equation in Eq. (30), we can get
$$
\mathcal H \boldsymbol{Y_0} = e^{ikl} \boldsymbol{Y_0} \\
$$
and the dispersion curve 
$$
|\mathcal H - e^{ikl}I| = 0.
$$

# 5 Piezoelectric beam with circuit (better derivation)

| <img src="/Users/wang/Documents/GitHub/wangshaoyun.github.io/_posts/assets/202211042004334.png" style="zoom:25%;" /> |
| :----------------------------------------------------------: |
|         Figure 3: Non-Hermitian SSH circuit and beam         |

## 5.1 Note

* Define

$$
\mathbf{z}=\left[w, w_x, M, Q, I, V \right]^{\mathrm{T}}
$$



* **The direction of circuit is along the $x$ axis.**

* **The index $a$ for $\mathbf{H}_a,\mathbf{C}_a,\mathbf{J}_a$ in this file is from 0 to 3, but it is from 1 to 4 in MATLAB.**



## 5.2 First segment

The beam equations are
$$
\mathbf{Y}_{1}=\mathbf{H}_0 \cdot \mathbf{Y}_{\mathrm{0}}
$$
The circuit equations are
$$
I_1 = I_0 \\
V_1 = -Z_{L_2} I_0 + V_0
$$
or
$$
\left(\begin{array}{l}
I_1 \\
V_1
\end{array}\right)=\left(\begin{array}{ll}
 1  &  0 \\
-Z_{L_2}  & 1
\end{array}\right)\left(\begin{array}{l}
I_0 \\
V_0
\end{array}\right) 
\equiv \mathbf{R}_0 \left(\begin{array}{l}
I_0 \\
V_0
\end{array}\right)
$$
Therefore, we have
$$
\mathbf{z}_{1}=\mathbf{T}_0 \cdot \mathbf{z}_{\mathrm{0}}
$$
where
$$
\mathbf{T}_0 = \left(\begin{array}{ll}
\mathbf{H}_0  & \mathbf{0}  \\
\mathbf{0} &  \mathbf{R}_0
\end{array}\right)
$$

## 5.3 Second segment

The beam transfer matrix equations are
$$
\mathbf{Y}_{\mathrm{2}}+\mathbf{C}_1^{-1} \mathbf{J}_1 V_2 = \mathbf{H}_1 \left(\mathbf{Y}_1+\mathbf{C}_1^{-1} \cdot \mathbf{J}_1 \cdot V_2\right)
$$
or
$$
\mathbf{Y}_{\mathrm{2}}+(I-\mathbf{H}_1)\mathbf{C}_1^{-1} \mathbf{J}_1 V_2 = \mathbf{H}_1 \mathbf{Y}_1
$$
Define $\mathbf{K}_1 = (I-\mathbf{H}_1)\mathbf{C}_1^{-1} \mathbf{J}_1$.

The circuit equations are
$$
I_2 = I_1 - i\omega \lambda \boldsymbol{J}\cdot(\boldsymbol{Y}_2-\boldsymbol{Y}_1) - i\omega C_p V_1 \\
V_2 = V_1
$$
where $C_p = b(l_2-l_1)\varepsilon^{S}_{33}/h_p$ , or
$$
I_2 + i\omega \lambda \boldsymbol{J}\boldsymbol{Y}_2 = I_1 + i\omega \lambda \boldsymbol{J}\boldsymbol{Y}_1 - i\omega C_p V_1 \\
V_2 = V_1
$$
So we have
$$
\mathbf{S}_1 \mathbf{z}_{2}=\mathbf{T}_1 \cdot \mathbf{z}_{\mathrm{1}}
$$
where
$$
\mathbf{T}_1 = \left[\begin{array}{cccc}
\mathbf{H}_1^{11} & \mathbf{H}_1^{12} & \mathbf{H}_1^{13} & \mathbf{H}_1^{14} & 0 & 0 \\
\mathbf{H}_1^{21} & \mathbf{H}_1^{22} & \mathbf{H}_1^{23} & \mathbf{H}_1^{24} & 0 & 0\\
\mathbf{H}_1^{31} & \mathbf{H}_1^{32} & \mathbf{H}_1^{33} & \mathbf{H}_1^{34} & 0 & 0 \\
\mathbf{H}_1^{41} & \mathbf{H}_1^{42} & \mathbf{H}_1^{43} & \mathbf{H}_1^{44} & 0 &0 \\
0 & i\omega \lambda & 0 & 0 & 1 & -i\omega C_p \\
0 & 0 & 0 & 0 & 0 & 1 \\
\end{array}\right], \quad
\mathbf{S}_1 = \left[\begin{array}{cccc}
1 & 0 & 0 & 0 & 0 & \mathbf{K}_1(1) \\
0 & 1 & 0 & 0 & 0 & \mathbf{K}_1(2)\\
0 & 0 & 1 & 0 & 0 & \mathbf{K}_1(3) \\
0 & 0 & 0 & 1 & 0 & \mathbf{K}_1(4) \\
0 & i\omega \lambda & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 \\
\end{array}\right],
$$

## 5.4 Third segment

The beam equations are
$$
\mathbf{Y}_{3}=\mathbf{H}_2 \cdot \mathbf{Y}_{\mathrm{2}}
$$
The circuit equations are
$$
\begin{array}{l}
I_{2}= v \left(V_{3}-V_{2}\right) -\gamma \left(V_{3}-V_{2}\right)  \\
I_{3}=v \left(V_{3}-V_{2}\right) + \gamma \left(V_{3}-V_{2}\right)
\end{array}
$$
or
$$
\begin{array}{l}
(v- \gamma)  V_{3} =  I_{2} + (v-\gamma) V_{2}\\
-I_{3} + (v + \gamma) V_{3} = (v+\gamma) V_{2}
\end{array}
$$
or
$$
\left(\begin{array}{ll}
0  &  v-\gamma \\
-1  & v+\gamma
\end{array}\right)\left(\begin{array}{l}
I_3 \\
V_3
\end{array}\right)=\left(\begin{array}{ll}
1  &  v-\gamma \\
0  & v+\gamma
\end{array}\right)\left(\begin{array}{l}
I_2 \\
V_2
\end{array}\right) 
\equiv 
\mathbf{L}_2 \left(\begin{array}{l}
I_3 \\
V_3
\end{array}\right) = 
\mathbf{R}_2 \left(\begin{array}{l}
I_2 \\
V_2
\end{array}\right)
$$
Therefore, we have
$$
\mathbf{S}_2 \mathbf{z}_{3}=\mathbf{T}_2 \cdot \mathbf{z}_{\mathrm{2}}
$$
where
$$
\mathbf{T}_2 = \left(\begin{array}{ll}
\mathbf{H}_2  & \mathbf{0}  \\
\mathbf{0} &  \mathbf{R}_2
\end{array}\right), \quad 
\mathbf{S}_2 = \left(\begin{array}{ll}
I  & \mathbf{0}  \\
\mathbf{0} &  \mathbf{L}_2
\end{array}\right) \\
$$

The circuit equations are
$$
\begin{array}{l}
I_{2}= Z_{L_1}^{-1} \left(V_{2}-V_{3}\right) - Z_{L_3}^{-1}Z_n/Z_p \left(V_{2}-V_{3}\right)  \\
I_{3}= Z_{L_1}^{-1} \left(V_{2}-V_{3}\right) + Z_{L_3}^{-1} \left(V_{2}-V_{3}\right)
\end{array}
$$
or
$$
\begin{array}{l}
(-Z_{L_1}^{-1}+ Z_{L_3}^{-1}Z_n/Z_p)  V_{3} =  I_{2} + (-Z_{L_1}^{-1} + Z_{L_3}^{-1}Z_n/Z_p) V_{2}\\
I_{3} + (Z_{L_1}^{-1}+ Z_{L_3}^{-1}) V_{3} = (Z_{L_1}^{-1}+ Z_{L_3}^{-1}) V_{2}
\end{array}
$$
or
$$
\left(\begin{array}{ll}
0  &  -Z_{L_1}^{-1}+ Z_{L_3}^{-1}Z_n/Z_p \\
1  &  Z_{L_1}^{-1}+ Z_{L_3}^{-1}
\end{array}\right)\left(\begin{array}{l}
I_3 \\
V_3
\end{array}\right)=\left(\begin{array}{ll}
1  &  -Z_{L_1}^{-1}+ Z_{L_3}^{-1}Z_n/Z_p \\
0  & Z_{L_1}^{-1}+ Z_{L_3}^{-1}
\end{array}\right)\left(\begin{array}{l}
I_2 \\
V_2
\end{array}\right) 
\equiv 
\mathbf{L}_2 \left(\begin{array}{l}
I_3 \\
V_3
\end{array}\right) = 
\mathbf{R}_2 \left(\begin{array}{l}
I_2 \\
V_2
\end{array}\right)
$$
Therefore, we have
$$
\mathbf{S}_2 \mathbf{z}_{3}=\mathbf{T}_2 \cdot \mathbf{z}_{\mathrm{2}}
$$
where
$$
\mathbf{T}_2 = \left(\begin{array}{ll}
\mathbf{H}_2  & \mathbf{0}  \\
\mathbf{0} &  \mathbf{R}_2
\end{array}\right), \quad 
\mathbf{S}_2 = \left(\begin{array}{ll}
I  & \mathbf{0}  \\
\mathbf{0} &  \mathbf{L}_2
\end{array}\right) \\
$$



## 5.5 Fourth segment

The beam transfer matrix equations are
$$
\mathbf{Y}_{\mathrm{4}}+\mathbf{C}_3^{-1} \mathbf{J}_3 V_4 = \mathbf{H}_3 \left(\mathbf{Y}_3+\mathbf{C}_3^{-1}  \mathbf{J}_3 V_4\right)
$$
or
$$
\mathbf{Y}_{\mathrm{4}}+(I-\mathbf{H}_3)\mathbf{C}_3^{-1} \mathbf{J}_3 V_4 = \mathbf{H}_3 \mathbf{Y}_3
$$
Define $\mathbf{K}_3 = (I-\mathbf{H}_3)\mathbf{C}_3^{-1} \mathbf{J}_3$.

The circuit equations are
$$
I_4 = I_3 - i\omega\lambda \boldsymbol{J}\cdot(\boldsymbol{Y}_4-\boldsymbol{Y}_3) - i\omega C_p V_3 \\
V_4 = V_3
$$
or
$$
I_4 + i\omega \lambda \boldsymbol{J}\boldsymbol{Y}_4 = I_3 + i\omega\lambda \boldsymbol{J}\boldsymbol{Y}_3 - i\omega C_p V_3\\
V_4 = V_3
$$
So we have
$$
\mathbf{S}_3 \mathbf{z}_{4}=\mathbf{T}_3 \cdot \mathbf{z}_{\mathrm{3}}
$$
where
$$
\mathbf{T}_3 = \left[\begin{array}{cccc}
\mathbf{H}_3^{11} & \mathbf{H}_3^{12} & \mathbf{H}_3^{13} & \mathbf{H}_3^{14} & 0 & 0 \\
\mathbf{H}_3^{11} & \mathbf{H}_3^{12} & \mathbf{H}_3^{13} & \mathbf{H}_3^{14} & 0 & 0\\
\mathbf{H}_3^{11} & \mathbf{H}_3^{12} & \mathbf{H}_3^{13} & \mathbf{H}_3^{14} & 0 & 0 \\
\mathbf{H}_3^{11} & \mathbf{H}_3^{12} & \mathbf{H}_3^{13} & \mathbf{H}_3^{14} & 0 &0 \\
0 & i\omega \lambda & 0 & 0 & 1 & -i\omega C_p \\
0 & 0 & 0 & 0 & 0 & 1 \\
\end{array}\right], \quad
\mathbf{S}_3 = \left[\begin{array}{cccc}
1 & 0 & 0 & 0 & 0 & \mathbf{K}_3(1) \\
0 & 1 & 0 & 0 & 0 & \mathbf{K}_3(2)\\
0 & 0 & 1 & 0 & 0 & \mathbf{K}_3(3) \\
0 & 0 & 0 & 1 & 0 & \mathbf{K}_3(4) \\
0 & i\omega \lambda & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 \\
\end{array}\right],
$$

## 5.6 Transfer matrix

The total transfer matrix is
$$
\mathbf{z}_{4}= \mathbf{S}_3^{-1} \mathbf{T}_3 \mathbf{S}_2^{-1} \mathbf{T}_2 \mathbf{S}_1^{-1} \mathbf{T}_1  \mathbf{T}_0  \mathbf{z}_{\mathrm{0}} \equiv \mathbf{T} \mathbf{z}_{0}
$$
Use the Bloch's boundary condition $\mathbf{z}_{4} = \mathbf{z}_{0} e^{ikl}$, we have
$$
(\mathbf{T} - I e^{ikl}) \mathbf{z}_{4} = 0
$$
The dispersion curves are
$$
|\mathbf{T} - I e^{ikl}| = 0
$$


# 6 Parameters

## 6.1 Original parameters

| $c_{11}^E$           |   $126~\text{GPa}$    | $E_b$    |   $210~\text{GPa}$   | $l_p$ | $1\text{cm}$ | $C_1$ | $0.4~\mu\text{F}$  |
| :------------------- | :-------------------: | :------- | :------------------: | :---- | :----------: | ----- | ------------------ |
| $e_{31}$             | $-6.5 ~ \text{C/m}^2$ | $\rho_b$ | $7850~\text{kg/m}^3$ | $h_b$ | $5\text{mm}$ | $C_2$ | $0.4~\mu\text{F}$  |
| $\varepsilon_{33}^S$ |  $1700\varepsilon_0$  | $l$      |     $5\text{cm}$     | $h_p$ | $2\text{mm}$ | $C_3$ | $0.4~\mu\text{F}$  |
| $\rho_p$             | $7500\ \text{kg/m}^3$ | $l_b$    |     $2\text{cm}$     | $b$   | $1\text{cm}$ | $L_1$ | $10.1~\mu\text{H}$ |

## 6.2 Derived parameters





# 7 Non-Hermitian SSH beam



# 8 Appendix

## 8.1 Bending moment from piezoelectric patch

Constitutive law
$$
\left[\begin{array}{l}
S_1 \\
D_3
\end{array}\right]=\left[\begin{array}{ll}
s_{11}^E & d_{31} \\
d_{31} & \varepsilon_{33}^T
\end{array}\right]\left[\begin{array}{c}
T_1 \\
E_3
\end{array}\right], 
$$
and we have
$$
\left[\begin{array}{l}
T_1 \\
D_3
\end{array}\right]=\left[\begin{array}{ll}
s_{11}^{-1} & -d_{31}/s_{11} \\
d_{31}/s_{11} & \varepsilon_{33} - d_{31}^2/s_{11}
\end{array}\right]\left[\begin{array}{c}
S_1 \\
E_3
\end{array}\right]
$$


where
$$
c_{11}^E = 1/s_{11}^E, \quad e_{31} = -d_{31}/s_{11}^E, \quad \varepsilon^S_{33} = \varepsilon^T_{33} - d_{31}^2/s_{11}^E.
$$
For the symmetric beam with attaching piezoelectric patches on both sides, the moment from piezoelectric patch is
$$
\begin{aligned}
M_p &= b\int_{h_b/2}^{h_b/2+h_p} T_1 z dz = b\int_{h_b/2}^{h_b/2+h_p} (c_{11}^E S_1+e_{31}E_3) z dz \\
 &= b\int_{h_b/2}^{h_b/2+h_p} (-c_{11}^E z w_{xx}-e_{31}V/h_p) z dz \\
 &= -c_{11}^E I_p w_{xx} - \frac{e_{31}bV}{2h_p}\left[ (h_p+h_b/2)^2-h_b^2/4\right] \\
 &= -c_{11}^E I_p w_{xx} + c_{11}^Ed_{31}b(h_p+h_b)V/2 = -c_{11}^E I_p w_{xx} + \lambda V
\end{aligned}
$$
where $ S_1=u_x=-z w_{xx}, E=-V/h_p$ is used.

For the beam with attaching piezoelectric patches on one side, $h_b/2$ is replaced by $h_c$.

## 8.2 Circuit from piezoelectric patch

The circuit is
$$
dI = bi\omega D_3 dx = bi\omega(e_{31}S_1+\varepsilon_{33}^S)dx 
 = bi\omega(-e_{31}zw_{xx}-\varepsilon_{33}^S V/h_p)|_{z=h_b/2+h_p} dx  \\
 = \left(-i\omega e_{31} b (h_b/2+h_p)w_{xx} - i\omega b\varepsilon^{S}_{33}/h_p V \right) dx
$$
Doing the integral along $x$ direction gives
$$
I = -i\omega e_{31} b (h_b/2+h_p)[w_{x}|_{x=l}-w_{x}|_{x=0}] - i\omega bl\varepsilon^{S}_{33}/h_p V \\
  = -i\omega e_{31} b (h_b/2+h_p)[w_{x}|_{x=l}-w_{x}|_{x=0}] - i\omega C_p V
$$
Little bit different from Eq. (70). 

## 8.3 Neutral axis position

> https://www.ecourses.ou.edu/cgi-bin/ebook.cgi?topic=me&chap_sec=06.1&page=theory

Parallel axis theorem:
$$
\int_{-a/2}^{a/2} (x+d)^2dx = \int_{-a/2}^{a/2} x^2+2dx+d^2 dx = \int_{-a/2}^{a/2} x^2 dx + ad^2
$$
Here the distance from neutral axis to the top surface of the elastic beam is
$$
h_c = \frac{E_b h_b^2-E_p h_p^2}{2\left(E_b h_b+E_p h_p\right)}
$$











> [1] Zhang, H., Wen, J. H., Chen, S. B., Wang, G., & Wen, X. S. (2015). Flexural wave band-gaps in phononic metamaterial beam with hybrid shunting circuits. *Chinese Physics B*, *24*(3), 036201.
>
> [2] ./code/beam.mlx
>
> [3] Helbig, T., Hofmann, T., Imhof, S., Abdelghany, M., Kiessling, T., Molenkamp, L. W., ... & Thomale, R. (2020). Generalized bulkâ€“boundary correspondence in non-Hermitian topolectrical circuits. *Nature Physics*, *16*(7), 747-750.
>
> [4] Yao, S., & Wang, Z. (2018). Edge states and topological invariants of non-Hermitian systems. *Physical review letters*, *121*(8), 086803.
>
> [5] Zheng, Y., Zhang, J., Qu, Y., & Meng, G. (2021). Adaptive nonreciprocal wave attenuation in linear piezoelectric metastructures shunted with one-way electrical transmission lines. *Journal of Sound and Vibration*, *503*, 116113.
>
> [6] Sugino, C., Leadenham, S., Ruzzene, M., & Erturk, A. (2017). An investigation of electroelastic bandgap formation in locally resonant piezoelectric metastructures. *Smart Materials and Structures*, *26*(5), 055029.
>
> 











